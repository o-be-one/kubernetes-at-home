apiVersion: v1
kind: ConfigMap
metadata:
  name: clickhouse-bootstrap
  namespace: rybbit
  labels:
    app.kubernetes.io/name: rybbit
    app.kubernetes.io/instance: rybbit
data:
  01_create_analytics_database.sh: |
    #!/bin/bash
    set -e
    echo "Creating analytics database for Rybbit..."
    # Wait a bit for ClickHouse to be fully ready
    sleep 10
    # Create database with explicit auth
    clickhouse client --user=default --password=your-secure-clickhouse-password -n <<-EOSQL
    CREATE DATABASE IF NOT EXISTS analytics;
    EOSQL
    echo "Analytics database created successfully!"